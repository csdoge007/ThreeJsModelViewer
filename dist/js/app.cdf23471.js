(function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],d=0,u=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);h&&h(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==r[l]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=i[0]))}return e}var a={},r={app:0},n=[];function s(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=a,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/ThreeJsModelViewer/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var h=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"179e":function(e,t,i){},"3c5f":function(e,t,i){"use strict";i("179e")},"56d7":function(e,t,i){"use strict";i.r(t);i("e623"),i("e379"),i("5dc8"),i("37e1");var a=i("2b0e"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("router-view")},n=[],s=i("2877"),o={},l=Object(s["a"])(o,r,n,!1,null,null,null),c=l.exports,h=(i("202f"),i("dfae")),d=i("0c63"),u=i("a600"),p=i("55f1"),m=i("160c"),g=i("fbdf"),f=i("9a63"),v=i("e32c"),b=i("cdeb"),y=i("f2ca"),w=i("f64c"),L=i("8c4f"),H=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("div",{staticClass:"modelList"},[i("a-card",{attrs:{title:"模型查看器展示"}},e._l(e.modellist,(function(t){return i("a-card-grid",{key:t.id,staticClass:"model",staticStyle:{width:"25%","text-align":"center",padding:"5px"}},[i("div",{staticClass:"image",on:{click:function(i){return e.renderModel(t)}}},[i("img",{attrs:{alt:"example",src:t.fileData.modelImage}})]),i("a-card-meta",{attrs:{title:t.fileData.resourceName}},[i("template",{slot:"description"},[i("div",{staticClass:"modelDownload",on:{click:function(i){return e.download(t.fileData.modelUrl)}}},[e._v(" "+e._s(t.fileData.modelUrl)+" ")])])],2)],1)})),1)],1),e.modalViewerFlag?i("modelviewer",{ref:"modelviewerCom",attrs:{model:e.model},on:{close:e.closemodelViewer}}):e._e()],1)},x=[],S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"modelviewer"},[i("div",{staticClass:"centent"},[i("div",{ref:"modelviewerMain",staticClass:"main"},[i("div",{staticClass:"toolMenu"},[i("div",{staticClass:"header"},[i("div",{staticClass:"header_left"},[e.model?i("div",{staticClass:"header_left_title"},[e._v(" "+e._s(e.model.fileData.resourceName)+" - ")]):e._e(),i("div",{staticClass:"header_left_text"},[e._v("3D 查看器")])]),i("div",{staticClass:"header_right"},[i("a-icon",{staticClass:"header_right_icon",attrs:{type:"zoom-in"},on:{click:function(){e.console.log("全屏")}}}),i("a-icon",{staticClass:"header_right_icon",attrs:{type:"close"},on:{click:e.closeModal}})],1)]),i("div",{staticClass:"tools"},e._l(e.toolMenu,(function(t){return i("div",{key:t.id,staticClass:"tool"},[i("a-dropdown",{attrs:{trigger:["click"],overlayClassName:"overlayClassName"}},[i("span",{staticClass:"toolTitle"},[e._v(e._s(t.name))]),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},e._l(t.children,(function(t){return i("a-menu-item",{key:t.id},[i("span",{staticClass:"toolTitle"},[i("a-icon",{attrs:{type:t.icon}}),e._v(" "+e._s(t.name)+" ")],1)])})),1)],1)],1)})),0)]),i("div",{staticClass:"view",staticStyle:{display:"flex"}},[e.getUIHelperFlag("toolUI","modelChildListHelper")?i("div",{staticClass:"childList"},[e._v(" 子集 ")]):e._e(),i("div",{staticClass:"iframebox",attrs:{id:"ModelViewerBox"}},[e.modelLoader_show?i("div",{staticClass:"progress"},[i("a-progress",{attrs:{type:"circle",percent:e.modelLoader_progress},scopedSlots:e._u([{key:"format",fn:function(t){return[i("div",{staticStyle:{color:"rgb(42, 74, 218)","margin-bottom":"10px"}},[e._v(" 模型加载中…… ")]),i("div",{staticStyle:{color:"rgb(42, 74, 218)"}},[e._v(e._s(t)+"%")])]}}],null,!1,1728773324)})],1):e._e()]),i("div",{staticClass:"rightMenu",style:{height:e.rightMenuHeight+"px"}},[i("a-collapse",{model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[i("a-collapse-panel",{attrs:{header:e.rightMenu.environmentUI.name}},[i("a-row",e._l(e.rightMenu.environmentUI.datalist,(function(e){return i("a-col",{key:e.id,attrs:{span:8}},[i("div",{staticClass:"colorBox",staticStyle:{width:"40px",height:"40px"},style:{backgroundColor:e.color}})])})),1)],1),i("a-collapse-panel",{attrs:{header:e.rightMenu.ligntUI.name}},[i("div",{staticClass:"lightSet"},e._l(e.rightMenu.ligntUI.childrenUI,(function(t){return i("div",{key:t.id,staticClass:"helperItem",class:t.id},[i("span",[e._v(e._s(t.name))]),i("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",defaultChecked:t.status},on:{change:function(i){return e.lightUIApi(t)}}})],1)})),0)]),i("a-collapse-panel",{attrs:{header:e.rightMenu.sceneUI.name}},[i("div",{staticClass:"sceneSet"},e._l(e.rightMenu.sceneUI.childrenUI,(function(t){return i("div",{key:t.id,staticClass:"helperItem",class:t.id},[i("span",[e._v(e._s(t.name))]),i("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",defaultChecked:t.status},on:{change:function(i){return e.sceneUIApi(t)}}})],1)})),0)]),i("a-collapse-panel",{attrs:{header:e.rightMenu.toolUI.name}},[i("div",{staticClass:"toolSet"},e._l(e.rightMenu.toolUI.childrenUI,(function(t){return i("div",{key:t.id,staticClass:"helperItem",class:t.id},[i("span",[e._v(e._s(t.name))]),i("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",defaultChecked:t.status},on:{change:function(i){return e.toolUIApi(t)}}})],1)})),0)])],1)],1)]),i("div",{staticClass:"footer"},[i("div",{staticClass:"animation"},[i("div",{staticClass:"play animationBtn"},[i("a-icon",{attrs:{type:"play-square"}})],1),i("div",{staticClass:"play animationBtn"},[i("a-icon",{attrs:{type:"sync"}})],1),i("div",{staticClass:"animationLine"},[i("a-slider",{attrs:{id:"test","default-value":30,disabled:!1}})],1)]),i("div",{staticClass:"tool"},[i("a-dropdown",{attrs:{trigger:["click"],overlayClassName:"overlayClassName"}},[i("span",{staticClass:"toolTitle"},[i("a-icon",{attrs:{type:"up-square"}}),e._v(" 快速动画"),i("a-icon",{attrs:{type:"up"}})],1),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[i("a-menu-item",[i("span",{staticClass:"toolTitle"},[i("a-icon",{attrs:{type:"desktop"}}),e._v(" 无 ")],1)]),i("a-menu-item",[i("span",{staticClass:"toolTitle"},[i("a-icon",{attrs:{type:"desktop"}}),e._v(" 转盘 ")],1)])],1)],1),i("a-dropdown",{attrs:{trigger:["click"],overlayClassName:"overlayClassName"}},[i("span",{staticClass:"toolTitle"},[i("a-icon",{staticStyle:{"font-size":"10px"},attrs:{type:"close"}}),e._v(" 1.0"),i("a-icon",{attrs:{type:"up"}})],1),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[i("a-menu-item",[i("span",{staticClass:"toolTitle"},[i("a-icon",{staticStyle:{"font-size":"10px"},attrs:{type:"close"}}),e._v(" 1.0 ")],1)]),i("a-menu-item",[i("span",{staticClass:"toolTitle"},[i("a-icon",{staticStyle:{"font-size":"10px"},attrs:{type:"close"}}),e._v(" 2.0 ")],1)])],1)],1)],1)])])])])},k=[],U=i("1da1"),_=(i("7db0"),i("d3b7"),i("96cf"),i("d4ec")),R=i("bee2"),C=(i("c0b6"),i("b0c0"),i("4160"),i("159b"),i("5a89")),D=i("4721"),M=i("aea1"),A=i("257e"),I=i("262e"),j=i("2caf"),K=(i("cb29"),function(e){Object(I["a"])(i,e);var t=Object(j["a"])(i);function i(e,a){var r;Object(_["a"])(this,i),r=t.call(this),r.container=a,r.editorCamera=e,r.point=new C["Sb"],r.dim=128,r.raycaster=new C["zb"],r.mouse=new C["Rb"],r.sceneOrtho=new C["Bb"],r.rendererOrtho=new C["Ub"]({antialias:!0,alpha:!0}),r.rendererOrtho.setSize(128,128);var n=document.createElement("div");n.id="viewHelper",n.style.position="absolute",n.style.right="0px",n.style.bottom="0px",n.style.height="128px",n.style.width="128px",n.addEventListener("mouseup",(function(e){e.stopPropagation(),e.preventDefault(),r.handleClick(e)})),n.addEventListener("mousedown",(function(e){e.stopPropagation()})),n.appendChild(r.rendererOrtho.domElement),a.appendChild(n),r.panel=n;var s=new C["hb"];s.name="view_helper";var o=new C["l"]("#ff3653"),l=new C["l"]("#8adb00"),c=new C["l"]("#2c8fff"),h=[],d=4,u=4,p=new C["jb"](-d/2,d/2,u/2,-u/2,-4,4);p.position.set(0,0,0),p.lookAt(0,0,0),r.camera=p;var m=new C["f"](.8,.05,.05).translate(.4,0,0),g=new C["X"](m,X(o)),f=new C["X"](m,X(l)),v=new C["X"](m,X(c));f.rotation.z=Math.PI/2,v.rotation.y=-Math.PI/2,console.log(Object(A["a"])(r),"this"),s.add(g),s.add(v),s.add(f);var b=new C["Jb"](Z(o,"X"));b.userData.type="posX";var y=new C["Jb"](Z(l,"Y"));y.userData.type="posY";var w=new C["Jb"](Z(c,"Z"));w.userData.type="posZ";var L=new C["Jb"](Z(o));L.userData.type="negX";var H=new C["Jb"](Z(l));H.userData.type="negY";var x=new C["Jb"](Z(c));return x.userData.type="negZ",b.position.x=1,y.position.y=1,w.position.z=1,L.position.x=-1,L.scale.setScalar(.8),H.position.y=-1,H.scale.setScalar(.8),x.position.z=-1,x.scale.setScalar(.8),s.add(b),s.add(y),s.add(w),s.add(L),s.add(H),s.add(x),h.push(b),h.push(y),h.push(w),h.push(L),h.push(H),h.push(x),r.posXAxisHelper=b,r.posYAxisHelper=y,r.posZAxisHelper=w,r.negXAxisHelper=L,r.negYAxisHelper=H,r.negZAxisHelper=x,r.interactiveObjects=h,r.sceneOrtho.add(s),r}return Object(R["a"])(i,[{key:"render",value:function(e,t,i){this.quaternion.copy(this.editorCamera.quaternion).invert(),this.updateMatrixWorld();var a=this.point;a.set(0,0,1),a.applyQuaternion(this.editorCamera.quaternion),a.x>=0?(this.posXAxisHelper.material.opacity=1,this.negXAxisHelper.material.opacity=.5):(this.posXAxisHelper.material.opacity=.5,this.negXAxisHelper.material.opacity=1),a.y>=0?(this.posYAxisHelper.material.opacity=1,this.negYAxisHelper.material.opacity=.5):(this.posYAxisHelper.material.opacity=.5,this.negYAxisHelper.material.opacity=1),a.z>=0?(this.posZAxisHelper.material.opacity=1,this.negZAxisHelper.material.opacity=.5):(this.posZAxisHelper.material.opacity=.5,this.negZAxisHelper.material.opacity=1),this.camera.position.set[0],this.camera.quaternion.copy(i.quaternion),this.rendererOrtho.render(this.sceneOrtho,this.camera)}},{key:"handleClick",value:function(e){this.mouse.x=e.offsetX/this.dim*2-1,this.mouse.y=-e.offsetY/this.dim*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.interactiveObjects);if(0!==t.length)switch(t[0].object.userData.type){case"posX":console.log("posX");break;case"posY":break;case"posZ":break;case"negX":break;case"negY":break;case"negZ":break;default:console.error("ViewHelper: Invalid axis.")}}}]),i}(C["hb"]));function X(e){return new C["Y"]({color:e,toneMapped:!1})}function Z(e,t){var i=document.createElement("canvas");i.width=64,i.height=64;var a=i.getContext("2d");a.beginPath(),a.arc(32,32,16,0,2*Math.PI),a.closePath(),a.fillStyle=e.getStyle(),a.fill(),t&&(a.font="24px Arial",a.textAlign="center",a.fillStyle="#000000",a.fillText(t,32,41));var r=new C["j"](i);return new C["Kb"]({map:r,toneMapped:!1})}i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("baa5"),i("ac1f"),i("1276"),i("e323"),i("c975"),i("d401"),i("81b2"),i("0eb6"),i("b7ef"),i("8bd4"),i("9257"),i("ace4"),i("5cc6"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("9129"),i("a9e3"),i("b680"),i("e25e"),i("99af"),i("a15b"),i("0d03"),i("c19f"),i("e9c4"),i("0dc0"),i("9e5c");var O=i("e642"),E=i("db27"),z=i("4086"),N=i("34ad"),V=(i("b1f1"),void 0);var P=function(e){return Number.isNaN(e)?"EMPTY":e<1024?e+"b":e<1048576?(e/1024).toFixed(1)+"k":e<1073741824?(e/1024/1024).toFixed(1)+"M":(e/1024/1024/1024).toFixed(1)+"G"},Y=function(e,t){return new Promise(function(){var i=Object(U["a"])(regeneratorRuntime.mark((function i(a){var r,n,s,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!e.fileData.resourceType||"glb"!==e.fileData.resourceType){i.next=12;break}return i.next=3,$({modelUrl:"".concat(e.fileData.modelUrl),fileName:e.fileData.resourceName},t);case 3:if(r=i.sent,r.status){i.next=7;break}return a({message:"加载失败",status:!1}),i.abrupt("return");case 7:return r.object.scene.name=e.fileData.resourceName,a({status:!0,object:r.object.scene}),i.abrupt("return");case 12:if(1!==e.fileData.type.length||"obj"!==e.fileData.type[0]){i.next=24;break}return i.next=15,G({modelUrl:"".concat(e.fileData.modelUrl),fileName:e.fileData.resourceName},t);case 15:if(n=i.sent,n.status){i.next=19;break}return a({message:"加载失败",status:!1}),i.abrupt("return");case 19:return n.object.name=e.fileData.resourceName,a({status:!0,object:n.object}),i.abrupt("return");case 24:if(2!==e.fileData.type.length||"obj"!==e.fileData.type[0]){i.next=36;break}return i.next=27,T({modelUrl:"".concat(e.fileData.modelUrl),fileName:e.fileData.resourceName},t);case 27:if(s=i.sent,s.status){i.next=31;break}return a({message:"加载失败",status:!1}),i.abrupt("return");case 31:return s.object.name=e.fileData.resourceName,a({status:!0,object:s.object}),i.abrupt("return");case 36:if("gltf"!==e.fileData.type[0]){i.next=49;break}return i.next=39,F({modelUrl:"".concat(e.fileData.modelUrl),fileName:e.fileData.resourceName},t);case 39:if(o=i.sent,o.status){i.next=44;break}return V.$message.error("加载失败"),a({message:"加载失败",status:!1}),i.abrupt("return");case 44:return o.object.scene.name=e.fileData.resourceName,a({status:!0,object:o.object.scene}),i.abrupt("return");case 49:return console.log("暂不支持"),a({message:"暂不支持",status:!1}),i.abrupt("return");case 52:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},T=function(e,t){return new Promise(function(){var i=Object(U["a"])(regeneratorRuntime.mark((function i(a){var r,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=new C["R"](t),n=function(){a({message:"加载模型失败",status:!1})},s=function(e){var i=parseInt(e.loaded/e.total*100),a=P(e.total);t({per:i,modelSize:a})},r.addHandler(/\.dds$/i,new E["a"]),new z["a"](r).load("".concat(e.modelUrl.substring(e.modelUrl.lastIndexOf("."),0),".mtl"),(function(t){t.preload(),new O["a"](r).setMaterials(t).load(e.modelUrl,function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a({message:"加载模型成功",status:!0,object:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s,n)}));case 5:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},G=function(e,t){return new Promise(function(){var i=Object(U["a"])(regeneratorRuntime.mark((function i(a){var r,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=new C["R"](t),n=function(){a({message:"加载模型失败",status:!1})},s=function(e){var i=parseInt(e.loaded/e.total*100),a=P(e.total);t({per:i,modelSize:a})},r.addHandler(/\.dds$/i,new E["a"]),new O["a"](r).load(e.modelUrl,function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a({message:"加载模型成功",status:!0,object:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s,n);case 5:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},F=function(e,t){return new Promise(function(){var i=Object(U["a"])(regeneratorRuntime.mark((function i(a){var r,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=new C["R"](t),n=function(){a({message:"加载模型失败",status:!1})},s=function(e){var i=parseInt(e.loaded/e.total*100),a=P(e.total);t({per:i,modelSize:a})},r.addHandler(/\.dds$/i,new E["a"]),new N["a"](r).load(e.modelUrl,function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a({message:"加载模型成功",status:!0,object:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s,n);case 5:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},$=function(e,t){return new Promise(function(){var i=Object(U["a"])(regeneratorRuntime.mark((function i(a){var r,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=new C["R"],n=function(){a({message:"加载模型失败",status:!1})},s=function(e){console.log(e,"加载模型");var i=parseInt(e.loaded/e.total*100),a=P(e.total);t({per:i,modelSize:a})},r.addHandler(/\.dds$/i,new E["a"]),new N["a"](r).load(e.modelUrl,function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a({message:"加载模型成功",status:!0,object:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s,n);case 5:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},q=function(){function e(t){Object(_["a"])(this,e),this.container=null,this.parantDom=null,this.scene=null,this.camera=null,this.renderer=null,this.orbitcontrols=null,this.gridHelper=null,this.viewHelper=null,this.planeHelper=null,this.model=null,this.modelSize=null,this.modelLabel=null,this.LightHelper={HemisphereLightHelper:null,SpotLightHelper:null,SpotLightshadowCameraHelper:null,DirectionalLightHelper_XZ:null,DirectionalLightHelper_XRZ:null,DirectionalLightHelper_RXZ:null,DirectionalLightHelper_RXRZ:null},this.Keylight={SpotLight:null},this.AuxiliaryLight={AmbientLight:null,HemisphereLight:null,DirectionalLight_XZ:null,DirectionalLight_XRZ:null,DirectionalLight_RXZ:null,DirectionalLight_RXRZ:null},this.rightMenu=t}return Object(R["a"])(e,[{key:"init",value:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t,i,a){var r,n,s,o,l,c,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(i,"model"),this.createContainer(t),this.createScene(),this.createCamera(),this.createRenderer(),this.createOrbitcontrols(),e.next=8,this.addModel(i,a);case 8:e.sent,r=this.rightMenu.ligntUI.childrenUI.find((function(e){return"AuxiliaryLight"===e.id})).status,r&&this.createAuxiliaryLight(),n=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Keylight"===e.id})).status,n&&this.createKeylight(),s=this.rightMenu.ligntUI.childrenUI.find((function(e){return"LightHelper"===e.id})).status,s&&this.createLightHelper(),o=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Shadow"===e.id})).status,o&&this.LightShadow(!0),l=this.rightMenu.sceneUI.childrenUI.find((function(e){return"gridHelper"===e.id})).status,l&&this.createGridHelper(),c=this.rightMenu.sceneUI.childrenUI.find((function(e){return"viewHelper"===e.id})).status,c&&this.createViewHelper(),h=this.rightMenu.sceneUI.childrenUI.find((function(e){return"planeHelper"===e.id})).status,h&&this.createPlaneHelper(),window.scene=this.scene,this.animate(),this.onWindowResize(),window.addEventListener("resize",this.onWindowResize.bind(this),!1);case 27:case"end":return e.stop()}}),e,this)})));function t(t,i,a){return e.apply(this,arguments)}return t}()},{key:"remove",value:function(){var e=this;console.log("移除画布");var t=function(e){},i=function(){console.log("清空renderer"),e.renderer.dispose(),e.renderer.forceContextLoss(),e.renderer.domElement=null,e.renderer=null};t(this.model),i();var a=document.getElementsByClassName("view")[0];a.removeChild(document.getElementById("ModelViewerBox"))}},{key:"createContainer",value:function(e){this.container=document.createElement("div"),this.container.globalAlpha=0,this.parantDom=document.querySelector("".concat(e));var t=this.parantDom.lastElementChild;while(t)this.parantDom.removeChild(t),t=this.parantDom.lastElementChild;this.parantDom.appendChild(this.container)}},{key:"createScene",value:function(){this.scene=new C["Bb"],this.scene.background=new C["l"](2171696)}},{key:"createCamera",value:function(){var e=this.parantDom.clientWidth/this.parantDom.clientHeight;this.camera=new C["lb"](50,e,1,3e4),this.camera.position.set(100,100,100),this.camera.name="Camera",this.camera.lookAt(new C["Sb"](100,100,100))}},{key:"createRenderer",value:function(){this.renderer=new C["Ub"]({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.parantDom.offsetWidth,this.parantDom.offsetHeight),this.container.appendChild(this.renderer.domElement),this.renderer.shadowMapEnabled=!0,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=C["kb"],this.renderer.render(this.scene,this.camera),this.labelRenderer=new M["b"],this.labelRenderer.setSize(this.parantDom.offsetWidth,this.parantDom.offsetHeight),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top="0px",this.container.appendChild(this.labelRenderer.domElement)}},{key:"createOrbitcontrols",value:function(){this.orbitcontrols=new D["a"](this.camera,this.labelRenderer.domElement),this.orbitcontrols.addEventListener("change",this.render.bind(this)),this.orbitcontrols.update()}},{key:"createViewHelper",value:function(){this.viewHelper=new K(this.camera,this.container),this.scene.add(this.viewHelper)}},{key:"removeViewHelper",value:function(){this.scene.remove(this.viewHelper),this.render();var e=document.getElementById("viewHelper");e.remove()}},{key:"createGridHelper",value:function(){this.gridHelper=new C["y"](300,100,4476262,2896450),this.gridHelper.position.set(0,0,-2),this.scene.add(this.gridHelper);var e=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Shadow"===e.id})).status;e&&this.LightShadow(!0)}},{key:"removeGridHelper",value:function(){this.scene.remove(this.gridHelper)}},{key:"createPlaneHelper",value:function(){var e=new C["f"](300,1,300),t=new C["Z"]({color:4476262,side:C["r"]});this.planeHelper=new C["X"](e,t),this.planeHelper.position.set(0,-1,0),this.scene.add(this.planeHelper);var i=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Shadow"===e.id})).status;i&&this.LightShadow(!0)}},{key:"removePlaneHelper",value:function(){this.scene.remove(this.planeHelper)}},{key:"addModel",value:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t,i){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(r){var n,s,o,l,c,h,d,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.model&&a.removeModel(),e.next=3,Y(t,i);case 3:if(n=e.sent,n.status){e.next=7;break}return r({message:n.message,status:!1}),e.abrupt("return");case 7:if(n.object){e.next=11;break}return console.log("读取模型失败"),r({message:"读取模型失败",status:!1}),e.abrupt("return");case 11:a.model=n.object,s=(new C["d"]).setFromObject(a.model),o=s.max.x-s.min.x,l=s.max.y-s.min.y,c=s.max.z-s.min.z,h=(o>c?o:c)>l?o>c?o:c:l,d=1,h<1&&(d=10,a.model.scale.set(d,d,d)),a.model.position.set(0,0,0),a.camera.updateProjectionMatrix(),a.cameraReset({x:h*d,y:l*d,z:h*d}),a.modelSize={x:h*d,y:l*d,z:h*d},console.log(a.modelSize,"this.modelSize"),a.scene.add(a.model),u=document.createElement("div"),u.className="label",u.style="color:#fff",u.textContent=a.model.name,a.modelLabel=new M["a"](u),a.modelLabel.position.set(0,l+1.5,0),a.model.add(a.modelLabel),r({message:"加载成功",status:!0});case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"removeModel",value:function(){this.model.remove(this.modelLabel),this.scene.remove(this.model)}},{key:"createLightHelper",value:function(){this.AuxiliaryLight.HemisphereLight&&(this.LightHelper.HemisphereLightHelper=new C["B"](this.AuxiliaryLight.HemisphereLight,5),this.scene.add(this.LightHelper.HemisphereLightHelper),this.LightHelper.DirectionalLightHelper_XZ=new C["q"](this.AuxiliaryLight.DirectionalLight_XZ,5),this.scene.add(this.LightHelper.DirectionalLightHelper_XZ),this.LightHelper.DirectionalLightHelper_XRZ=new C["q"](this.AuxiliaryLight.DirectionalLight_XRZ,5),this.scene.add(this.LightHelper.DirectionalLightHelper_XRZ),this.LightHelper.DirectionalLightHelper_RXZ=new C["q"](this.AuxiliaryLight.DirectionalLight_RXZ,5),this.scene.add(this.LightHelper.DirectionalLightHelper_RXZ),this.LightHelper.DirectionalLightHelper_RXRZ=new C["q"](this.AuxiliaryLight.DirectionalLight_RXRZ,5),this.scene.add(this.LightHelper.DirectionalLightHelper_RXRZ)),this.Keylight.SpotLight&&(this.LightHelper.SpotLightHelper=new C["Ib"](this.Keylight.SpotLight),this.scene.add(this.LightHelper.SpotLightHelper),this.LightHelper.SpotLightshadowCameraHelper=new C["i"](this.Keylight.SpotLight.shadow.camera),this.LightHelper.SpotLightshadowCameraHelper.visible=!0,this.scene.add(this.LightHelper.SpotLightshadowCameraHelper))}},{key:"removeLightHelper",value:function(){this.LightHelper.HemisphereLightHelper&&this.scene.remove(this.LightHelper.HemisphereLightHelper),this.LightHelper.SpotLightHelper&&this.scene.remove(this.LightHelper.SpotLightHelper),this.LightHelper.SpotLightshadowCameraHelper&&this.scene.remove(this.LightHelper.SpotLightshadowCameraHelper),this.LightHelper.DirectionalLightHelper_XZ&&this.scene.remove(this.LightHelper.DirectionalLightHelper_XZ),this.LightHelper.DirectionalLightHelper_RXZ&&this.scene.remove(this.LightHelper.DirectionalLightHelper_RXZ),this.LightHelper.DirectionalLightHelper_XRZ&&this.scene.remove(this.LightHelper.DirectionalLightHelper_XRZ),this.LightHelper.DirectionalLightHelper_RXRZ&&this.scene.remove(this.LightHelper.DirectionalLightHelper_RXRZ)}},{key:"createAuxiliaryLight",value:function(){this.AuxiliaryLight.AmbientLight=new C["a"](6710886,1),this.AuxiliaryLight.HemisphereLight=new C["A"](16777215,0,.1),this.AuxiliaryLight.DirectionalLight_XZ=new C["p"](16777215,.05),this.AuxiliaryLight.DirectionalLight_XRZ=new C["p"](16777215,.05),this.AuxiliaryLight.DirectionalLight_RXZ=new C["p"](16777215,.05),this.AuxiliaryLight.DirectionalLight_RXRZ=new C["p"](16777215,.05),this.updateLight();var e=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Shadow"===e.id})).status;e&&this.LightShadow(!0),this.scene.add(this.AuxiliaryLight.AmbientLight),this.scene.add(this.AuxiliaryLight.HemisphereLight),this.scene.add(this.AuxiliaryLight.DirectionalLight_XZ),this.scene.add(this.AuxiliaryLight.DirectionalLight_XRZ),this.scene.add(this.AuxiliaryLight.DirectionalLight_RXZ),this.scene.add(this.AuxiliaryLight.DirectionalLight_RXRZ)}},{key:"removeAuxiliaryLight",value:function(){this.scene.remove(this.AuxiliaryLight.AmbientLight),this.scene.remove(this.AuxiliaryLight.HemisphereLight)}},{key:"createKeylight",value:function(){this.Keylight.SpotLight=new C["Hb"](16777215),this.Keylight.SpotLight.position.set(17,45,27),this.Keylight.SpotLight.intensity=2,this.Keylight.SpotLight.angle=Math.PI/3,this.Keylight.SpotLight.distance=1e3,this.Keylight.SpotLight.exponent=1,this.Keylight.SpotLight.decay=1.5,this.Keylight.SpotLight.penumbra=.7,this.updateLight();var e=this.rightMenu.ligntUI.childrenUI.find((function(e){return"Shadow"===e.id})).status;e&&this.LightShadow(!0),this.scene.add(this.Keylight.SpotLight)}},{key:"removeKeylight",value:function(){this.scene.remove(this.Keylight.SpotLight),this.scene.remove(this.Keylight.DirectionalLight)}},{key:"updateLight",value:function(e){var t=this.modelSize?1*this.modelSize.x:0,i=this.modelSize?1*this.modelSize.y:0,a=this.modelSize?1*this.modelSize.z:0;this.AuxiliaryLight&&(this.AuxiliaryLight.AmbientLight.position.set(0,2.5*i,0),this.AuxiliaryLight.HemisphereLight.position.set(0,2.5*i,0),this.AuxiliaryLight.DirectionalLight_XZ.position.set(1.5*t,.35*i,1.5*a),this.AuxiliaryLight.DirectionalLight_XRZ.position.set(1.5*t,.35*i,1.5*-a),this.AuxiliaryLight.DirectionalLight_RXZ.position.set(1.5*-t,.35*i,1.5*a),this.AuxiliaryLight.DirectionalLight_RXRZ.position.set(1.5*-t,.35*i,1.5*-a)),this.Keylight.SpotLight&&(this.Keylight.SpotLight.position.set(t?t+40:17,i?5*i:45,a?a+40:27),this.Keylight.SpotLight.target=this.model)}},{key:"LightShadow",value:function(e){var t=!!e;this.Keylight.SpotLight&&(this.Keylight.SpotLight.castShadow=t,this.Keylight.SpotLight.receiveShadow=t,this.Keylight.SpotLight.shadow.mapSize.width=512,this.Keylight.SpotLight.shadow.mapSize.height=512,this.Keylight.SpotLight.shadow.radius=1,this.Keylight.SpotLight.shadow.camera.near=20,this.Keylight.SpotLight.shadow.camera.far=5e4,this.Keylight.SpotLight.shadow.fov=10,this.Keylight.SpotLight.shadow.focus=1);var i=function e(i){i.children&&i.children.forEach((function(i){"Mesh"===i.type&&(i.castShadow=t),i.children&&i.children.length>0&&e(i)}))};this.model&&i(this.model),this.planeHelper&&(console.log(t,"planeHelper阴影"),this.planeHelper.receiveShadow=t),this.gridHelper&&(console.log(t,"gridHelper阴影"),this.gridHelper.receiveShadow=t)}},{key:"render",value:function(){this.renderer&&(this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.viewHelper&&this.viewHelper.render(this.renderer,this.scene,this.camera),this.labelRenderer.render(this.scene,this.camera))}},{key:"cameraReset",value:function(e){this.camera.position.set(e.x,e.y,e.z),this.orbitcontrols.target.set(0,0,0),this.orbitcontrols.update(),this.animate()}},{key:"onWindowResize",value:function(){this.camera.aspect=this.parantDom.offsetWidth/this.parantDom.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.parantDom.offsetWidth,this.parantDom.offsetHeight)}},{key:"animate",value:function(){requestAnimationFrame(this.animate.bind(this)),this.render()}}]),e}(),B={name:"Modelviewer",props:["model"],data:function(){return{visible:!0,modelLoader_progress:0,modelLoader_show:!1,modelLoader_text:"",toolMenu:[{id:"file",name:"文件",children:[{id:"export",name:"导出",icon:"download"},{id:"screenshot",name:"截图",icon:"picture"}]},{id:"edit",name:"编辑",children:[{id:"disassemble",name:"拆解",icon:"unlock"}]},{id:"tool",name:"工具",children:[{id:"statistics",name:"统计信息",icon:"file-search"},{id:"sectioning",name:"剖切",icon:"to-top"}]},{id:"viewer",name:"查看",children:[{id:"blast",name:"爆炸",icon:"global"},{id:"measure",name:"测量",icon:"gateway"},{id:"ResetCamera",name:"重置相机",icon:"cloud-sync"}]}],rightMenu:{environmentUI:{name:"环境设置",datalist:[{id:1,color:"#ccc"},{id:2,color:"#FF4400"},{id:3,color:"#000000"},{id:4,color:"#FFF9AD"},{id:5,color:"#97C7C9"},{id:6,color:"#FF9000"}]},ligntUI:{id:"ligntUI",name:"灯光设置",childrenUI:[{id:"LightHelper",name:"灯光辅助器",status:!1},{id:"AuxiliaryLight",name:"辅助灯光",status:!0},{id:"Keylight",name:"主灯光",status:!0},{id:"Shadow",name:"阴影",status:!0}]},sceneUI:{id:"sceneUI",name:"场景控件",childrenUI:[{id:"gridHelper",name:"网格辅助",status:!1},{id:"viewHelper",name:"坐标辅助",status:!0},{id:"planeHelper",name:"平面辅助",status:!0}]},toolUI:{id:"toolUI",name:"工具控件",childrenUI:[{id:"modelChildListHelper",name:"模型层级",status:!1}]}},activeKey:[],RenderModelApi:null,rightMenuHeight:0}},watch:{activeKey:function(e){}},mounted:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.rightMenuHeight=e.$refs.modelviewerMain.clientHeight-80-50,e.RenderModelApi=new q(e.rightMenu),e.RenderModelApi.init("#ModelViewerBox",e.model,e.loaderModel);case 3:case"end":return t.stop()}}),t)})))()},methods:{loaderModel:function(e){console.log(e,"模型加载"),e&&(this.modelLoader_show=!0,this.modelLoader_progress=e.per,this.modelLoader_text="加载中…… 文件大小：".concat(e.modelSize),100===e.per&&(this.modelLoader_show=!1))},lightUIApi:function(e){console.log(e,"灯光设置"),e.status=!e.status,this.RenderModelApi.model?"LightHelper"!==e.id?"AuxiliaryLight"!==e.id?"Keylight"!==e.id?"Shadow"!==e.id||(e.status?this.RenderModelApi.LightShadow(!0):this.RenderModelApi.LightShadow(!1)):e.status?this.RenderModelApi.createKeylight():this.RenderModelApi.removeKeylight():e.status?this.RenderModelApi.createAuxiliaryLight():this.RenderModelApi.removeAuxiliaryLight():e.status?this.RenderModelApi.createLightHelper():this.RenderModelApi.removeLightHelper():this.$message.warning("请选择模型")},sceneUIApi:function(e){console.log(e,"场景设置"),e.status=!e.status,this.RenderModelApi.model?("gridHelper"===e.id&&(e.status?this.RenderModelApi.createGridHelper():this.RenderModelApi.removeGridHelper()),"viewHelper"===e.id&&(e.status?this.RenderModelApi.createViewHelper():this.RenderModelApi.removeViewHelper()),"planeHelper"===e.id&&(e.status?this.RenderModelApi.createPlaneHelper():this.RenderModelApi.removePlaneHelper())):this.$message.warning("请选择模型")},toolUIApi:function(e){console.log(e,"场景设置"),e.status=!e.status,e.id},getUIHelperFlag:function(e,t){return this.rightMenu[e].childrenUI.find((function(e){return e.id===t})).status},closeModal:function(){this.RenderModelApi.remove(),this.$emit("close")}}},J=B,W=(i("3c5f"),i("7f67"),Object(s["a"])(J,S,k,!1,null,"552f6db0",null)),Q=W.exports,ee={name:"home",data:function(){return{modalViewerFlag:!1,model:null,modellist:[]}},components:{modelviewer:Q},mounted:function(){var e=[{id:String(1e3*Math.random()),fileData:{resourceName:"办公大楼",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/54e669e8-a9d2-4a69-b78e-d74f3f506612.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/7ea3b300-7e6d-49bf-9116-f842bd717151.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"别墅",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/c41dda32-e825-4992-b66c-ee085f6a81c9.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/2b5ac99c-ead9-4370-bc93-50094fb81559.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"操作台",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/9bc07ca8-2ada-4911-b692-f17d55cdf6d2.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/a712c0e6-5ff2-4e1a-862d-e52d7d8df98b.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"高楼",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/eb2b16cc-a612-4743-8cee-41310211af44.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/85de8f71-32f6-4c76-be6d-eacda606e7b6.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"卡车",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/d39169a6-a5f8-4e75-b01d-35c6d22ee8eb.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/2c62bdf4-e6b0-4349-98eb-0ea00587e710.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"沙滩",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/83b40c08-061c-4a75-ae6e-906a68e1c06d.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/19f4ea78-a00f-41d9-8de0-671a9000b741.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"体育场",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/ec36f185-d066-4f16-9188-00e7c86e220b.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/7aa19249-f61d-4c4b-9b2e-fd4fbf224038.glb",resourceType:"glb",type:["glb"]}},{id:String(1e3*Math.random()),fileData:{resourceName:"文字特效",modelImage:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/83235b78-3f8b-400a-b558-6255fce17646.png",modelUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-d3ca2bf9-a00e-476d-9447-92a65ac1a70a/22a10ee8-5c84-4dd8-98d0-9809cecbb0ca.glb",resourceType:"glb",type:["glb"]}}];this.modellist=e},methods:{renderModel:function(e){this.modalViewerFlag=!0,this.model=e},download:function(e){window.open(e)},closemodelViewer:function(){this.modalViewerFlag=!1}}},te=ee,ie=(i("ad29"),Object(s["a"])(te,H,x,!1,null,"c4c48efa",null)),ae=ie.exports;a["a"].use(L["a"]);var re=[{path:"/",redirect:"/home"},{path:"/home",component:ae,name:"Home",children:[]}],ne=new L["a"]({mode:"hash",routes:re}),se=ne;a["a"].use(h["a"]),a["a"].use(d["a"]),a["a"].use(u["a"]),a["a"].use(p["a"]),a["a"].use(m["a"]),a["a"].use(g["a"]),a["a"].use(f["a"]),a["a"].use(v["a"]),a["a"].use(b["a"]),a["a"].use(y["a"]),a["a"].prototype.$message=w["a"],new a["a"]({router:se,render:function(e){return e(c)}}).$mount("#app")},"7f67":function(e,t,i){"use strict";i("e99b")},"881b":function(e,t,i){},ad29:function(e,t,i){"use strict";i("881b")},e99b:function(e,t,i){}});